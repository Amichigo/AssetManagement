<div bsModal #createOrEditModal="bs-modal" class="modal fade" tabindex="-1" role="dialog"
     aria-labelledby="createOrEditModal" aria-hidden="true" [config]="{backdrop: 'static'}">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <form #editForm="ngForm" novalidate (ngSubmit)="save()">
                <div class="modal-header">
                    <h4 class="modal-title">
                        <span *ngIf="phieugoihang.id">Cập nhật phiếu gọi hàng: {{phieugoihang.planCode}}</span>
                        <span *ngIf="!phieugoihang.id">Tạo mới phiếu gọi hàng</span>
                    </h4>
                    <button type="button" class="close" (click)="close()" [attr.aria-label]="l('Close')">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body row">
                    <div class="form-group col-sm-4">
                        <label>Số PO *</label>
                        <input #addressInput="ngModel" class="form-control" type="text" name="maKeHoach"
                               [(ngModel)]="phieugoihang.planCode" required maxlength="64">
                        <validation-messages [formCtrl]="addressInput"></validation-messages>
                    </div>
                    <div class="form-group col-sm-4">
                        <label>Tên đơn hàng *</label>
                        <input #addressInput="ngModel" class="form-control" type="text" name="tenKeHoach"
                               [(ngModel)]="phieugoihang.planName" required maxlength="64">
                        <validation-messages [formCtrl]="addressInput"></validation-messages>
                    </div>
                    <!--<div class="form-group col-sm-4">
        <label>Tên hợp đồng *</label>
        <select #hopdongthauCombobox name="tenHopDong" class="form-control" [(ngModel)]="phieugoihang.contractName"
                [attr.data-live-search]="true" jq-plugin="selectpicker" required>
            <option selected disabled value="">---Chọn Hợp Đồng Thầu---</option>
            <optgroup label="Hợp đồng mua lẻ">
                <option>Tài sản thông thường</option>
                <option>Công cụ lao động</option>
            </optgroup>
            <optgroup label="Hợp đồng thầu">
                <option *ngFor="let item of hopDongThaus" [value]="item.displayText">{{item.displayText}}</option>
            </optgroup>
        </select>
    </div>-->
                    <div class="form-group col-sm-4">
                        <label>Mã hợp đồng *</label>
                        <p class="input-group">
                            <input #addressInput="ngModel" class="form-control" type="text" name="tenHopDong"
                                   [(ngModel)]="phieugoihang.contractName" required maxlength="64">
                            <span class="input-group-append">
                                <button type="button" class="btn btn-info input-group-text" data-toggle="modal" data-target="#myModalHopDongHangHoa"><span class="fa fa-folder-open"></span></button>
                            </span>
                        </p>
                        <validation-messages [formCtrl]="addressInput"></validation-messages>
                    </div>
                    <div class="form-group col-sm-4">
                        <label>Hàng Hóa *</label>
                        <p class="input-group">
                            <input #addressInput="ngModel" class="form-control" type="text" name="hangHoaHopDong"
                                   [(ngModel)]="hangHoaHopDong" required maxlength="64">
                        </p>
                        <validation-messages [formCtrl]="addressInput"></validation-messages>
                    </div>
                    <div class="modal fade" id="myModalHopDongHangHoa" role="dialog">
                        <div class="modal-dialog modal-lg">
                            <div class="modal-content">
                                <div class="modal-body">
                                    <div class="form-group col-sm-11" style="margin-left: 3%;">
                                        <ngForm #duanForm="ngForm" autocomplete="off">
                                            <div class="m-form m-form--label-align-right" id="TextsFilterForm">
                                                <div class="row align-items-center m--margin-bottom-10">
                                                    <div class="col-sm-12">
                                                        <div class="input-group">
                                                            <input [(ngModel)]="hopdongthauCode" name="hopdongthauCode" autoFocus class="form-control"
                                                                   placeholder="Nhập mã hợp đồng" type="text">
                                                            <span class="input-group-btn">
                                                                <button (click)="applyFiltersHopDongHangHoa()" class="btn btn-primary" type="button">
                                                                    <i class="icon-refresh"></i>
                                                                    {{l("Refresh")}}
                                                                </button>
                                                            </span>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </ngForm>

                                        <div class="row align-items-center">
                                            <table class="table table-striped table-bordered">
                                                <thead>
                                                    <tr>
                                                        <th>Tên hàng hóa</th>
                                                        <th>Chủng loại</th>
                                                        <th>Đơn giá</th>
                                                        <th>Tên nhà cung cấp</th>
                                                        <th>Action</th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    <tr *ngFor="let listhopdonghanghoa of listHopDongHangHoa">
                                                        <td>{{listhopdonghanghoa.goodsName}}</td>
                                                        <td>{{listhopdonghanghoa.type}}</td>
                                                        <td>{{listhopdonghanghoa.price}}</td>
                                                        <td>{{listhopdonghanghoa.supplierName}}</td>
                                                        <td>
                                                            <button type="button" class="bg-danger" (click)="onSelectHopDongHangHoa(listhopdonghanghoa.type, listhopdonghanghoa.goodsName)" style="border-radius: 5px 5px; cursor:pointer;"><span class="fa fa-trash"></span></button>
                                                        </td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!--<div class="form-group">
                        <label>Tên đơn vị *</label>
                        <select #donvithauCombobox name="tenDonVi" class="form-control" [(ngModel)]="phieugoihang.unitName"
                                [attr.data-live-search]="true" jq-plugin="selectpicker" required>
                            <option selected disabled value="">---Chọn Đơn Vị---</option>
                            <option [value]="">Hà Nội</option>
                            <option [value]="">Thành Phố Hồ Chí Minh</option>
                            <option [value]="">Đà Nẵng</option>
                        </select>
                    </div>-->
                    <div class="form-group col-sm-4">
                        <label>Mã nhà cung cấp *</label>
                        <p class="input-group">
                            <input #addressInput="ngModel" class="form-control" type="text" name="tenDonVi"
                                   [(ngModel)]="phieugoihang.unitName" required maxlength="64">
                            <span class="input-group-append">
                                <button type="button" class="btn btn-info input-group-text" data-toggle="modal" data-target="#myModalDonViThau"><span class="fa fa-folder-open"></span></button>
                            </span>
                        </p>
                        <validation-messages [formCtrl]="addressInput"></validation-messages>
                    </div>
                    <div class="form-group col-sm-4">
                        <label>Tên nhà cung cấp *</label>
                        <p class="input-group">
                            <input #addressInput="ngModel" class="form-control" type="text" name="tenDonVi"
                                   [(ngModel)]="tenDonVi" required maxlength="64">
                        </p>
                        <validation-messages [formCtrl]="addressInput"></validation-messages>
                    </div>

                    <div class="form-group col-sm-4">
                        <label>Địa chỉ *</label>
                        <p class="input-group">
                            <input #addressInput="ngModel" class="form-control" type="text" name="diaChi"
                                   [(ngModel)]="diaChi" required maxlength="64">
                        </p>
                        <validation-messages [formCtrl]="addressInput"></validation-messages>
                    </div>


                    <div class="modal fade" id="myModalDonViThau" role="dialog">
                        <div class="modal-dialog modal-lg">
                            <div class="modal-content">
                                <div class="modal-body">
                                    <div class="form-group col-sm-11" style="margin-left: 3%;">
                                        <ngForm #nhacungcapForm="ngForm" autocomplete="off">
                                            <div class="m-form m-form--label-align-right" id="TextsFilterForm">
                                                <div class="row align-items-center m--margin-bottom-10">
                                                    <div class="col-sm-12">
                                                        <div class="input-group">
                                                            <input [(ngModel)]="nhacungcapName" name="nhacungcapName" autoFocus class="form-control"
                                                                   placeholder="Nhập tên đơn vị" type="text">
                                                            <span class="input-group-btn">
                                                                <button (click)="applyFiltersNhaCungCap()" class="btn btn-primary" type="button">
                                                                    <i class="icon-refresh"></i>
                                                                    {{l("Refresh")}}
                                                                </button>
                                                            </span>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </ngForm>

                                        <div class="row align-items-center">
                                            <!--<Primeng-TurboTable-Start>-->
                                            <div class="primeng-datatable-container" [busyIf]="primengTableHelper.isLoading">
                                                <p-table #dataTable (onLazyLoad)="getNhaCungCaps($event)" [value]="primengTableHelper.records"
                                                         rows="{{primengTableHelper.defaultRecordsCountPerPage}}" [paginator]="false" [lazy]="true"
                                                         [responsive]="primengTableHelper.isResponsive">
                                                    <ng-template pTemplate="header">
                                                        <tr>
                                                            <th pSortableColumn="name">
                                                                Mã đơn vị
                                                                <p-sortIcon field="name"></p-sortIcon>
                                                            </th>
                                                            <th pSortableColumn="address">
                                                                Tên đơn vị
                                                            </th>
                                                            <th pSortableColumn="info">
                                                                Địa chỉ
                                                                <p-sortIcon field="info"></p-sortIcon>
                                                            </th>
                                                            <th pSortableColumn="info">
                                                                Số điện thoại
                                                                <p-sortIcon field="info"></p-sortIcon>
                                                            <th pSortableColumn="info">
                                                                Email
                                                                <p-sortIcon field="info"></p-sortIcon>
                                                            </th>
                                                            <th pSortableColumn="info">
                                                                Action
                                                                <p-sortIcon field="info"></p-sortIcon>
                                                            </th>
                                                        </tr>
                                                    </ng-template>
                                                    <ng-template pTemplate="body" let-record="$implicit">
                                                        <tr>
                                                            <td>
                                                                <span class="ui-column-title">Mã đơn vị</span>
                                                                <span title="{{record.supplierCode}}">{{truncateString(record.supplierCode)}}</span>
                                                            </td>
                                                            <td>
                                                                <span class="ui-column-title">Tên đơn vị</span>
                                                                <span title="{{record.supplierName}}">{{truncateString(record.supplierName)}}</span>
                                                            </td>
                                                            <td>
                                                                <span class="ui-column-title">Địa chỉ</span>
                                                                <span title="{{record.address}}">{{truncateString(record.address)}}</span>
                                                            </td>
                                                            <td>
                                                                <span class="ui-column-title">Số điện thoại</span>
                                                                <span title="{{record.phoneNumber}}">{{truncateString(record.phoneNumber)}}</span>
                                                            </td>
                                                            <td>
                                                                <span class="ui-column-title">Email</span>
                                                                <span title="{{record.email}}">{{truncateString(record.email)}}</span>
                                                            </td>
                                                            <td>
                                                                <button type="button" class="bg-success" *ngIf="record.supplierCode" (click)="onSelectNhaCungCap(record)" style="border-radius: 5px 5px; cursor:pointer;"><span class="fa fa-plus"></span></button>
                                                            </td>
                                                        </tr>
                                                    </ng-template>
                                                </p-table>
                                                <div class="primeng-no-data" *ngIf="primengTableHelper.totalRecordsCount == 0">
                                                    {{l('NoData')}}
                                                </div>
                                                <div class="primeng-paging-container">
                                                    <p-paginator rows="{{primengTableHelper.defaultRecordsCountPerPage}}" #paginator
                                                                 (onPageChange)="getNhaCungCaps($event)"
                                                                 [totalRecords]="primengTableHelper.totalRecordsCount"
                                                                 [rowsPerPageOptions]="primengTableHelper.predefinedRecordsCountPerPage">
                                                    </p-paginator>
                                                    <span class="total-records-count">
                                                        {{l('TotalRecordsCount', primengTableHelper.totalRecordsCount)}}
                                                    </span>
                                                </div>
                                            </div>
                                            <!--<Primeng-TurboTable-End>-->
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Tên hàng hóa *</label>
                        <input #addressInput="ngModel" class="form-control" type="text" name="tenHangHoa"
                               [(ngModel)]="phieugoihang.goodsName" required maxlength="64">
                        <validation-messages [formCtrl]="addressInput"></validation-messages>
                    </div>
                    <div class="form-group row">
                        <div class="col-sm-6">
                            <label>Số lượng *</label>
                            <input #addressInput="ngModel" class="form-control" type="number" name="soLuong" min="1"
                                   [(ngModel)]="phieugoihang.amount" required maxlength="64">
                            <validation-messages [formCtrl]="addressInput"></validation-messages>
                        </div>
                        <div class="col-sm-6">
                            <label>Đơn giá *</label>
                            <input #addressInput="ngModel" class="form-control" type="text" name="donGia"
                                   [(ngModel)]="phieugoihang.price" required maxlength="64">
                            <validation-messages [formCtrl]="addressInput"></validation-messages>
                        </div>
                    </div>
                    <div class="form-group row">
                        <div class="col-sm-4">
                            <label>Quá trình thanh toán *</label>
                            <select #quatrinhthanhtoanCombobox name="quaTrinhThanhToan" class="form-control" [(ngModel)]="phieugoihang.paymentProcess"
                                    [attr.data-live-search]="true" jq-plugin="selectpicker" required>
                                <option selected disabled value="">---Quá Trình Thanh Toán---</option>
                                <option [value]="">Thanh toán trực tiếp</option>
                                <option [value]="">Thanh toán bằng thẻ ngân hàng</option>
                                <option [value]="">Thanh toán bằng thẻ giao dịch quốc tế (VISA/MASTER CARD)</option>
                            </select>
                        </div>
                        <div class="col-sm-4">
                            <label>Tiến độ giao hàng *</label>
                            <select #tiendogiaohangCombobox name="tienDoGiaoHang" class="form-control" [(ngModel)]="phieugoihang.shippingProcess"
                                    [attr.data-live-search]="true" jq-plugin="selectpicker" required>
                                <option selected disabled value="">---Tiến Độ Giao Hàng---</option>
                                <option [value]="">Đang giao hàng</option>
                                <option [value]="">Đang chờ</option>
                                <option [value]="">Đã hủy hàng</option>
                            </select>
                        </div>
                        <div class="col-sm-4">
                            <label>Tình trạng hóa đơn *</label>
                            <select #tinhtranghoadonCombobox name="tinhTrangHoaDon" class="form-control" [(ngModel)]="phieugoihang.billStatus"
                                    [attr.data-live-search]="true" jq-plugin="selectpicker" required>
                                <option selected disabled value="">---Tình Trạng Hóa Đơn---</option>
                                <option [value]="">Đang thanh toán</option>
                                <option [value]="">Chưa thanh toán</option>
                                <option [value]="">Đã hủy hóa đơn</option>
                            </select>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button [disabled]="saving" type="button" class="btn btn-default"
                            (click)="close()">
                        {{l("Cancel")}}
                    </button>
                    <button type="submit" class="btn btn-primary" [buttonBusy]="saving"
                            [busyText]="l('SavingWithThreeDot')">
                        <i class="fa fa-save"></i>
                        <span>{{l("Save")}}</span>
                    </button>
                </div>
            </form>
            <!--<p>Form Error:</p>
            <pre>{{editForm.controls.email?.errors | json}}</pre>-->
        </div>
    </div>
</div>
